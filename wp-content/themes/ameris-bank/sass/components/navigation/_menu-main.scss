

//
//
// -------------------- MOBILE MENU & DEFAULTS
//
//

#primary-menu > li {
	border-bottom: 1px solid rgba(255,255,255,.3);
	position: static;
	&:last-child {
		border: none;
	}
}

.main-navigation {
	@include rem-fallback(font-size, 1.8);
	ul {
		//display: none;
		@include element-invisible;
	}
}

.nav-menu {
	a {
		color: $white;
		text-transform: uppercase;
		font-family: $font-heading;
		font-weight: 700;
		display: block;
		@include rem-fallback(padding, 1.5, 1.5, 2);
		transition: background .5s, color .5s;
	}

	li li, .right-side, .stacked-sub {
		a {
			@include boldbluetext;
			margin-bottom: 0;
			color: $white;
			@include rem-fallback(padding, 1, 1.5);
			@include rem-fallback(font-size, 1.6);
		}
		li {
			a {
				font-weight: 300;
				text-transform: none;

			}
		}
	}

	li.active > ul, li.active > .tab-container > ul,  {
		display: block;
		@include element-invisible-off;
	}
	li.active, li:hover, li.focus {
		.stacked-container > ul, , .right-container > ul {
		@include element-invisible-off;
	}
	}

	.menu-item-has-children {
		> a {
			position: relative;
			&:after {
				content: "";
				display: block;
				position: absolute;
				@include rem-fallback(top, 2.2);
				@include rem-fallback(right, 1.6);
				@include use-sprite(arrow-white-right-small);
				transform: rotate(90deg);
				opacity: 1;
				transition: all .3s;
			}
		}
		&.active > a:after {
			transform: rotate(0deg);
			//border-top-color: $link-color;
			//opacity: 0;
		}
	}
	li .menu-item-has-children {
		> a:after {
			position: relative;
			display: inline-block;
			@include rem-fallback(top, .2);
			left: 0;
			@include rem-fallback(margin-left, 1);
		}
	}

}

.item-description {
	//display: none;
	@include element-invisible;
	h3 {
		@include voice;
		color: $darkblue;
	}
}

.menu-toggle {
	padding: 0;
	display: block;
	position: absolute;
	@include rem-fallback(top, 2);
	@include rem-fallback(right, 5);
	background: transparent;
	&:hover, &:active {
		background: transparent;
	}
}

@include breakpoint($mobile) {
	.sub-menu .column {
		width: 100% !important;
	}
}


@include breakpoint($tablet-to-desktop) {
	.menu-toggle {
		@include rem-fallback(right, 3);
	}
}


.main-navigation.toggled ul.menu {
	display: block;
	@include element-invisible-off;
}

//
//
// -------------------- END MOBILE MENU
//
//


//
//
// -------------------- START TABLET MENU
//
//


.main-navigation {
	clear: both;
	&.toggled {
		
	}
}

@include breakpoint( $narrow-to-desktop ) { //START DESKTOP SIZES


.menu-toggle {
	display: none;
}

#primary-menu > li {
	border-bottom: none;
}

.main-navigation {
	text-align: right;
	@include rem-fallback(margin-right, 1);
	ul {
		@include element-invisible-off;
		display: block;
	}
	.view-all a {
		@include red-link;
	}
}

.nav-menu {

	a {
		@include rem-fallback(padding, 1.5, 1, 2);
		@include rem-fallback(font-size, 1.6);
		position: relative;
		&:hover, &:focus {
			background-color: $white;
			color: $link-color;
		}
	}

	ul { // hiding sublevels for now
		//display:none;
		@include element-invisible;
	}


	li li , .right-side, .stacked-sub {
		a {
			@include rem-fallback(font-size, 1.2);
			border: 0 solid $paleblue;
			@include rem-fallback(border-bottom-width, .2);
			color: $link-color;
			@include rem-fallback(padding, 1, 0);
			@include rem-fallback(margin-bottom, 1);
			line-height: 1;

			&:after {
				content: "";
				display: inline-block;
				position: relative;
				@include rem-fallback(top, .2);
				left: 0;
				@include use-sprite(arrow-red-right-small);
				transform: rotate(0deg);
				@include rem-fallback(margin-left, 1);
				transition: all .3s;
			}
			&:hover {
				background-color: transparent;
			}
			&:hover:after {
				@include rem-fallback(left, .5);
			}
		}
		li a {

			@include rem-fallback(padding, .4, 0);
			@include rem-fallback(font-size, 1.4);
			border-bottom-width: 0;
			margin-bottom: 0;
			&:after {
				content: none;
			}
		}
	}

	.stacked-sub  {
		a {
			margin: 0;
		}
		&.menu-item-has-children > a {
			@include rem-fallback(margin-bottom, 1);
		}
	}


	li.active, li:hover, li.focus {
		> ul, .stacked-container > ul, , .right-container > ul {
			@include element-invisible-off;
		}
	}

	> li.active > ul, > li:hover > ul, > li.focus > ul {
		width: 100%;
		position: absolute !important;
	}

	.menu-item-has-children > a:after { //remove arrows from top nav
		content: none;
	}

	li .menu-item-has-children > a:after {
		content: ""; // add arrows back to children with children
		transform: rotate(0); //remove the rotate from mobile for the right arrows
		@include use-sprite(arrow-red-right-small);
	}
	ul ul {
		@include element-invisible-off;
		display: block; // show the nested lists by default, even though the dropdowns are hidden til hover
	}

	// set up top nav item styles
	> li {
		display: inline-block;
		transition: all .2s;
		&:hover, &:focus {
			background-color: $white;
			color: $link-color;
			> a {
				color: $link-color;
			}
		}
	}

	// position dropdowns
	> li > ul {
		position: absolute;
		text-align: left;
		color: $link-color;
		left: 0;
		width: 100%;
		margin: 0 auto;
		background: rgba(255,255,255,.9);
		box-shadow: 0 3px 6px rgba(0,0,0,.1);
		z-index: 10;
	}

	// parent item border bottoms
	> .current-page-ancestor > a:after, > .current_page_item > a:after {
		content: "";
		display: block;
		position: absolute;
		width: 100%;
		top: auto; //reset the before positioning from the mobile arrows
		right: 0; //reset the before positioning from the mobile arrows
		@include rem-fallback(bottom, -.5); //set the position to just below the blue bar (same as height)
		@include rem-fallback(height, .5);
		background: $red;
		transform: none;
	}

	.toggle-sub {

		li li {
			display: table-cell;
			@include rem-fallback(padding, 0, 1);

			a {
				//@include rem-fallback(border-bottom-width, .2);
				font-weight: 700;
				text-transform: uppercase;
			}
		}

		li li li {
			padding: 0;
			display: block;

			a {
				//border-bottom-width: 0;
				margin-bottom: 0;
				font-weight: 500;
				text-transform: none;
			}
		}
	}

}

	.business-nav.toggle-sub .toggle-sub__parent {
		//position: absolute;
		> a {
			@include rem-fallback(padding, 2);
			margin-bottom: 0;
		}
	}



.tab-container { //the right-hand side of the business navigation subnavs
	float: right;
	@include element-invisible;
	@include clearfix();

	> .item-description {
		@include element-invisible-off;
		@include rem-fallback(padding, 3);
		float: left;
		clear: left;
		width: 76%;
		background: $white;
		a {
			@include red-link();
		}
		h3 {
			@include rem-fallback(font-size, 3.2);
			@include rem-fallback(line-height, 3.2);
		}
		p {
			color: $text-color;
			@include rem-fallback(font-size, 2);
		}
	}
	> .sub-menu {
		@include rem-fallback(padding, 3);
		background: $white;
		position: static;
		transition: opacity .2s;
		float: left;
		clear: left;
		width: 76%;
	}
	.right-container {
		position: absolute;
		right: 0;
		top: 0;
		float: right;
		clear: none;
		width: 24%;
		@include rem-fallback(padding, 3, 1);
		.right-side {
			display: block;
		}
	}
}
	
	//Sub Menu with additional menu toggles (business subs)
	.toggle-sub__parent { // class placed inside of the dropdown
		
		width: 100%;
		
		> a {
			@include rem-fallback(padding, 3);
			@include red-arrow-right;
			@include rem-fallback(line-height, 3.2);
			float: left;
			clear: left;
			width: 25%;
			border-bottom: 2px solid transparent;
			text-transform: none;
			transition: all .2s;
			opacity: .7;
			
			&:hover {
				background: $white;
			}
		}
		
		&:hover//, &:first-child
		{
			background: transparent;
			> a {
				border-color: $red;
				opacity: 1;
			}
			.tab-container {
				@include element-invisible-off;
				width: 75% !important;
				position: relative !important;
				opacity: 1;
				pointer-events: all;
			}
		}
	}

//Open Sub Navs (any subs that have all the children exposed)
.open-sub {

	> .sub-menu {
		@include clearfix();
		@include rem-fallback(padding, 1.4, 0, 3.6);
	}
	> .sub-menu > li {
		@include rem-fallback(padding, 0, 2.4);
	}
	> .sub-menu .right-container {
		width: 24%;
		float: right;
	}

	> .sub-menu:before {
		content: "";
		position: absolute;
		left: 0;
		top: 0;
		width: 76%;
		height: 100%;
		background: rgba(255, 255, 255, .8);
	}

	&:hover {
		> .sub-menu {
			//@include element-invisible-off;
			display: table;
			> li {
				//display: table-cell;
				//@include rem-fallback(padding, 0, 1); //add space between menu lists
				> .sub-menu {
					display: block;
				}
			}
		}
	}
}

//Personal Sub Nav
.personal-nav {

	> .sub-menu > li {
		display: block;
		width: 19%;
		float: left;
	}

}

//Business Sub Nav
.business-nav {

}

//SBA Financing Sub Nav
.sba-nav {

	> .sub-menu .stacked-container {
		width: 24%;
		float: left;
	}
	.left-52 {
		float: left;
		width: 52%;
	}

	.nav-cta a {
		@include red-button-cta;
		@include cta-arrow-right;
		@include rem-fallback(padding, .8, 2, 1.5, 1.5);
		@include rem-fallback(font-size, 1.6);
		@include rem-fallback(margin-top, 1.4);
		border-bottom: none;
		text-transform: none;
	}
}


//Residential Financing Sub Nav
.residential-nav {
	> .sub-menu > li {
		display: block;
		width: 38%;
		float: left;
	}
	> .sub-menu .stacked-container {
		width: 38%;
	}
}


} //END NARROW SIZES




// START  DESKTOP ONLY SIZES
@include breakpoint($desktop) {
	.main-navigation {
		@include rem-fallback(margin-right, 3);
	}
	.nav-menu {
		a {
			@include rem-fallback(padding, 1.5, 1.5, 2);
			@include rem-fallback(font-size, 1.8);
		}
		li a {
			@include rem-fallback(font-size, 1.6);
		}
		li li , .right-side, .stacked-sub {
			a {
				@include rem-fallback(font-size, 1.6);
			}
			li a {
				@include rem-fallback(font-size, 1.6);
			}
		}
	}
	.sba-nav .nav-cta a {
		@include rem-fallback(padding, 1.7, 3, 2);
		@include rem-fallback(font-size, 1.8);
	}
	.toggle-sub__parent {
		> a {
			width: 30%;
		}
		&:hover .tab-container {
			width: 70% !important;
		}
	}
	.business-nav.toggle-sub .toggle-sub__parent > a {
		@include rem-fallback(padding, 3);
	}
}


// START  WIDE ONLY SIZES
@include breakpoint($wide) {
	.nav-menu {
		a {
			@include rem-fallback(padding, 1.5, 2, 2);
			@include rem-fallback(font-size, 1.8);
		}
		li a {
			@include rem-fallback(font-size, 1.8);
		}
		> li {
			@include rem-fallback(margin-right, 1);
		}
	}
	.main-navigation {
		@include rem-fallback(margin-right, 1);
	}
}

